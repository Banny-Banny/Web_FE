# 기능 명세서: 마이페이지 캡슐보관함

**Feature Branch**: `012-mypage-capsule-storage`  
**작성일**: 2025-01-30  
**상태**: 초안  
**입력**: 마이페이지 캡슐보관함 기능 명세 (웹) 2.1.25

---

## 개요

마이페이지에서 사용자가 참여 중인 타임캡슐을 한곳에서 구분하여 보고, 작성 중인 캡슐은 바로 작성 화면으로 이동하고, 이미 개봉된 캡슐은 내용을 확인하며, 아직 개봉되지 않은 캡슐은 열리는 날짜와 D-day만 확인할 수 있는 기능입니다.

### 배경

사용자는 자신이 참여한 타임캡슐이 “지금 작성 중인 것”, “이미 열린 것”, “아직 안 열린 것”으로 나뉜다는 것을 인지하고, 각 상태에 맞는 행동(작성하기, 내용 보기, 개봉일 확인)을 할 수 있어야 합니다. 이를 위해 마이페이지에 캡슐보관함을 두어 참여 캡슐을 상태별로 모아 보고, 필요한 화면으로 이동하거나 내용을 조회할 수 있게 합니다.

### 목적

- 참여 중인 타임캡슐을 “캡슐 대기실”, “열린 캡슐”, “잠긴 캡슐”로 구분하여 한 화면에서 파악할 수 있게 함
- 작성 중인 캡슐(대기실)에서 진행 상황·참여자·남은 시간을 보고, 한 번의 선택으로 작성 화면에 들어갈 수 있게 함
- 이미 개봉된 캡슐의 위치·날짜·내용(텍스트·이미지·영상·오디오)을 상세하게 볼 수 있게 함
- 아직 개봉되지 않은 캡슐은 열리는 날짜와 D-day만 보여 주고, 개봉 전에는 내용을 노출하지 않음

---

## 기능 요구사항

### FR-1: 캡슐보관함 진입 및 전체 구분 표시

**설명**: 사용자가 마이페이지에서 캡슐보관함에 들어가면, 참여 중인 캡슐이 “캡슐 대기실”, “열린 캡슐”, “잠긴 캡슐”로 구분되어 표시되고, 각 구역별 개수가 안내됩니다.

**수락 기준**:
- 캡슐보관함 화면에 “캡슐 대기실”, “열린 캡슐”, “잠긴 캡슐” 구역이 구분되어 존재함
- 화면 상단 또는 서브타이틀에 “열린 캡슐 N개 · 잠긴 캡슐 N개”처럼 열린/잠긴 개수가 동적으로 표시됨
- 캡슐이 하나도 없을 경우 각 구역에 “캡슐이 없어요” 등 안내 메시지가 표시됨
- 목록 조회 중에는 로딩 상태가 표시됨
- 조회 실패 시 사용자에게 오류 메시지가 표시되고, 재시도 또는 닫기가 가능함

### FR-2: 캡슐 대기실 — 목록 및 작성 화면 이동

**설명**: “캡슐 대기실”에는 아직 참여자들이 작성 중인 캡슐만 표시됩니다. 각 캡슐마다 제목, 진행 상황(완료 인원/전체 인원), 참여자 수, 남은 제출 시간(또는 “마감됨”)이 보이고, 항목을 선택하면 해당 캡슐의 작성(대기실) 화면으로 이동합니다.

**수락 기준**:
- 캡슐 대기실 섹션에 “N개”처럼 대기실 캡슐 개수가 표시됨
- 각 캡슐 카드에 캡슐 제목이 표시됨
- 각 캡슐에 대해 “완료 인원/전체 인원” 형태의 진행 상황이 표시됨
- 참여자 수(또는 참여자 요약)가 표시되며, 완료한 참여자와 미완료 참여자를 구분해 표시할 수 있음
- 제출 마감 시간이 있는 경우 “N일 N시간 N분” 또는 “마감됨” 형태로 남은 시간이 표시됨
- 대기실 캡슐 항목을 선택하면 해당 캡슐의 작성(대기실) 페이지로 이동하여 사용자가 캡슐 내용을 작성할 수 있음
- 대기실에 캡슐이 없을 경우 해당 섹션에 안내 메시지가 표시됨

### FR-3: 열린 캡슐 — 목록 및 상세 보기

**설명**: “열린 캡슐”에는 이미 개봉된 캡슐만 표시됩니다. 목록에는 캡슐 제목, 위치(주소), 묻은 날짜, 열린 날짜가 보이고, 항목을 선택하면 상세 모달에서 각 참여자의 텍스트·이미지·영상·오디오를 확인할 수 있습니다.

**수락 기준**:
- 열린 캡슐 전용 탭 또는 섹션이 있으며, “열린 캡슐 (N)”처럼 개수가 표시됨
- 각 열린 캡슐 카드에 캡슐 제목, 위치(행정구역 주소 등), 묻은 날짜, 열린 날짜가 표시됨
- 열린 캡슐 항목을 선택하면 상세 모달이 열림
- 상세 모달에서 캡슐 제목과 참여자(작성자) 목록이 표시됨
- 참여자(아바타·이름)를 선택하면 해당 참여자의 슬롯 콘텐츠로 전환됨
- 콘텐츠 영역에서 텍스트 메시지, 이미지(캐러셀/갤러리), 영상(재생 가능), 오디오(재생 가능)를 확인할 수 있음
- 모달을 닫으면 목록 화면으로 돌아감(ESC, 오버레이 클릭, 닫기 버튼 모두 지원)
- 열린 캡슐이 없을 경우 “열린 캡슐이 없어요” 등 안내 메시지가 표시됨

### FR-4: 잠긴 캡슐 — 목록만 표시(내용 비공개)

**설명**: “잠긴 캡슐”에는 아직 개봉되지 않은 캡슐만 표시됩니다. 목록에는 캡슐 제목, 묻은 날짜, 열리는 날짜, D-day(또는 “오늘 개봉”, “개봉됨”)가 보이고, 개봉 전에는 내용을 볼 수 없습니다.

**수락 기준**:
- 잠긴 캡슐 전용 탭 또는 섹션이 있으며, “잠긴 캡슐 (N)”처럼 개수가 표시됨
- 각 잠긴 캡슐 카드에 캡슐 제목, 묻은 날짜, 열리는 날짜가 표시됨
- 하단 또는 푸터에 “D-N일 남음”, “오늘 개봉”, “개봉됨” 중 하나가 표시됨
- 잠긴 캡슐 항목을 선택해도 내용 상세는 열리지 않으며(또는 “아직 개봉 전이에요” 안내만 표시), 목록 조회만 가능함
- 잠긴 캡슐이 없을 경우 “잠긴 캡슐이 없어요” 등 안내 메시지가 표시됨

### FR-5: 캡슐보관함 닫기 및 진입 경로

**설명**: 사용자는 캡슐보관함 화면을 닫아 마이페이지(또는 이전 화면)로 돌아갈 수 있고, 마이페이지에서 캡슐보관함으로 들어오는 진입 경로가 명확해야 합니다.

**수락 기준**:
- 캡슐보관함 화면에 “캡슐보관함” 제목과 우측 상단 닫기 버튼이 있음
- 닫기 버튼 선택 시 캡슐보관함이 닫히고 마이페이지(또는 이전 화면)로 이동함
- 마이페이지에서 “캡슐보관함” 또는 이에 상응하는 메뉴/영역을 통해 캡슐보관함에 진입할 수 있음

---

## 사용자 시나리오

### 시나리오 1: 캡슐보관함에서 작성 중인 캡슐로 이동해 작성하기

1. 사용자가 마이페이지에서 캡슐보관함을 연다.
2. “캡슐 대기실” 섹션에 참여 중인 캡슐들이 제목·진행률·참여자·남은 시간과 함께 표시된다.
3. 사용자가 아직 작성하지 않은 캡슐 카드를 선택한다.
4. 해당 캡슐의 대기실(작성) 페이지로 이동한다.
5. 사용자가 캡슐 내용을 작성할 수 있다.

### 시나리오 2: 열린 캡슐 내용 확인하기

1. 사용자가 캡슐보관함에서 “열린 캡슐” 탭(또는 섹션)을 본다.
2. 열린 캡슐 목록에서 보고 싶은 캡슐을 선택한다.
3. 상세 모달이 열리고, 캡슐 제목과 참여자 목록이 표시된다.
4. 사용자가 특정 참여자를 선택하면 해당 참여자의 텍스트·이미지·영상·오디오를 본다.
5. 다른 참여자를 선택하면 해당 참여자의 콘텐츠로 전환된다.
6. 모달을 닫으면 열린 캡슐 목록으로 돌아간다.

### 시나리오 3: 잠긴 캡슐의 개봉일만 확인하기

1. 사용자가 캡슐보관함에서 “잠긴 캡슐” 탭(또는 섹션)을 본다.
2. 아직 개봉되지 않은 캡슐 목록에 묻은 날짜, 열리는 날짜, “D-N일 남음” 등이 표시된다.
3. 사용자는 개봉일과 D-day만 확인할 수 있고, 항목을 눌러도 내용은 보이지 않는다(또는 “아직 개봉 전이에요” 안내만 표시).

### 시나리오 4: 캡슐이 없을 때

1. 사용자가 캡슐보관함에 진입한다.
2. 대기실·열린 캡슐·잠긴 캡슐 중 특정 구역에 항목이 하나도 없다.
3. 해당 구역에 “캡슐이 없어요” 등 상황에 맞는 안내 메시지가 표시된다.

### 시나리오 5: 캡슐보관함 닫고 마이페이지로 돌아가기

1. 사용자가 캡슐보관함을 보고 있다.
2. 우측 상단 닫기 버튼을 누르거나(또는 지정된 닫기 동작을 수행) 캡슐보관함을 닫는다.
3. 마이페이지(또는 이전 화면)로 돌아간다.

---

## 성공 기준

### SC-1: 상태별 구분 및 개수

- 캡슐보관함 진입 후 5초 이내에 참여 캡슐 목록이 “대기실 / 열린 / 잠긴”으로 구분되어 표시됨
- “열린 캡슐 N개 · 잠긴 캡슐 N개” 등 서브타이틀 또는 탭의 개수가 실제 분류 결과와 일치함

### SC-2: 대기실 → 작성 화면 이동

- 대기실 캡슐 카드 선택 후 한 번의 전환으로 해당 캡슐의 작성(대기실) 페이지에 도달함
- 해당 페이지에서 사용자가 캡슐 내용을 작성할 수 있는 상태가 됨

### SC-3: 열린 캡슐 상세 보기

- 열린 캡슐 항목 선택 후 상세 모달이 열리고, 참여자별로 텍스트·이미지·영상·오디오를 확인할 수 있음
- 참여자 전환 시 해당 참여자의 콘텐츠만 노출되며, 모달 닫기 시 목록으로 복귀함

### SC-4: 잠긴 캡슐 내용 비공개

- 잠긴 캡슐 목록에서는 묻은 날짜·열리는 날짜·D-day만 표시되고, 개봉 전에는 캡슐 내용이 노출되지 않음

### SC-5: 사용자 경험

- 목록 조회 중 로딩 상태가 표시됨
- 조회·상세 열기 실패 시 오류 메시지와 복구(재시도·닫기) 방법이 제공됨
- 캡슐이 없는 구역에는 안내 메시지가 표시됨

---

## 핵심 엔티티

### 타임캡슐(참여 목록용)

- **식별자**: 캡슐을 구분하는 고유 값
- **제목**: 캡슐 이름 — 목록·상세에 표시
- **상태**: “작성 중(대기실)” / “이미 개봉(열림)” / “아직 미개봉(잠김)” 구분에 사용
- **개봉일**: 캡슐이 열리는 날짜·시각 — 잠긴/열린 구분 및 D-day 계산에 사용
- **제출 마감**: 작성 마감 시각 — 대기실에서 “남은 시간” 또는 “마감됨” 표시에 사용
- **참여 인원 수**: 전체 참여자 수, 작성 완료 인원 수 — 대기실 진행률·참여자 표시에 사용
- **내 작성 여부**: 현재 사용자가 해당 캡슐에 작성했는지 여부
- **위치(선택)**: 위도·경도 또는 주소 — 열린 캡슐 목록·상세에 표시

### 타임캡슐 상세(열린 캡슐용)

- **캡슐 제목·참여자(슬롯) 목록**: 각 슬롯별 작성자 식별자·이름·표시용 이모지(또는 아바타)
- **슬롯별 콘텐츠**: 텍스트, 이미지 목록, 영상(1개), 오디오(1개) — 상세 모달에서 참여자 선택 시 표시

### 캡슐보관함 화면 구분

- **캡슐 대기실**: 참여자들이 아직 작성 중인 캡슐만 포함
- **열린 캡슐**: 이미 개봉된 캡슐만 포함
- **잠긴 캡슐**: 아직 개봉되지 않은 캡슐만 포함

(분류 규칙: “개봉일 ≤ 현재 시각”이면 열린 캡슐, “개봉일 > 현재 시각”이면 잠긴 캡슐. 개봉일이 없으면 서버에서 내려주는 상태 값으로 열림/잠김을 구분할 수 있음.)

---

## 비기능 요구사항

### NFR-1: 성능

- 캡슐보관함 목록 최초 로드: 5초 이내
- 대기실 카드 선택 후 작성 페이지 전환: 3초 이내
- 열린 캡슐 상세 모달 열기: 3초 이내

### NFR-2: 사용자 경험

- 목록·상세 조회 시 로딩 상태가 표시됨
- 오류 시 사용자에게 이해 가능한 메시지와 닫기·재시도 등 복구 방법이 제공됨
- 모바일·태블릿·데스크톱에서 모두 사용 가능한 반응형 레이아웃이 적용됨

### NFR-3: 접근성

- 키보드로 캡슐보관함 내 탐색·선택·닫기가 가능함
- 버튼·링크에 적절한 라벨 또는 접근성 속성이 제공됨
- 모달 열림/닫힘 시 포커스가 적절히 이동함

---

## 제약사항

- 캡슐 분류(대기실/열린/잠긴)는 서버에서 제공하는 “상태·개봉일·마감일” 등 데이터에 의존함
- 열린 캡슐 상세는 “이미 개봉된 캡슐”에만 제공되며, 권한이 없는 사용자에게는 오류 메시지로 안내함
- 위치(주소) 표시는 외부 지도/주소 서비스를 사용할 수 있으며, 해당 서비스 장애 시 주소가 비어 있을 수 있음

---

## 가정사항

- 사용자는 로그인된 상태로 마이페이지 및 캡슐보관함에 접근함
- 참여 중인 캡슐 목록과 타임캡슐 상세를 제공하는 백엔드가 존재함
- “대기실(작성) 페이지”의 경로와 쿼리(예: 캡슐 식별자)가 앱 내에서 정의되어 있음
- 열린 캡슐 상세 데이터에 슬롯별 작성자 정보와 텍스트·이미지·영상·오디오 URL(또는 스트리밍 정보)이 포함됨

---

## 엣지 케이스

### EC-1: 참여 캡슐이 하나도 없음

- 대기실·열린·잠긴 모두 비어 있으면 각 섹션에 “캡슐이 없어요” 등 안내 메시지를 표시함

### EC-2: 목록 조회 실패(네트워크·서버 오류)

- 오류 메시지를 표시하고, 재시도 또는 닫기 버튼을 제공함
- 오류 시에도 화면이 깨지지 않고 빈 목록 또는 안내 문구로 대체할 수 있음

### EC-3: 열린 캡슐 상세 조회 실패(권한 없음·캡슐 없음·미결제 등)

- 모달에서 “권한이 없어요”, “캡슐을 찾을 수 없어요” 등 메시지를 표시하고, 모달을 닫을 수 있게 함

### EC-4: 개봉일이 없는 캡슐

- 서버에서 내려주는 “상태” 값(예: 완료/만료/매장 등)으로 열린 캡슐/잠긴 캡슐 구분에 사용함

### EC-5: 마감이 지난 대기실 캡슐

- “마감됨”으로 표시하고, 선택 시 작성 페이지로 이동할 수 있으나, 실제 제출 가능 여부는 서버 정책에 따름
