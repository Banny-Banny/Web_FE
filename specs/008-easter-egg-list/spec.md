# 기능 명세서: 이스터에그 목록 페이지

## 개요

사용자가 마이페이지에서 자신의 이스터에그 목록을 확인하고, 각 이스터에그의 상세 정보를 조회할 수 있는 기능입니다. 사용자는 발견한 이스터에그와 심은 이스터에그를 구분하여 확인할 수 있으며, 각 항목을 클릭하여 상세 정보를 모달로 확인할 수 있습니다.

### 배경

현재 마이페이지에는 이스터에그 개수만 표시되고 있으며, 사용자가 자신이 발견하거나 심은 이스터에그의 목록을 확인할 수 있는 기능이 없습니다. 사용자는 자신의 이스터에그 활동 내역을 한눈에 파악하고, 각 이스터에그의 상세 정보를 확인할 수 있어야 합니다.

### 목적

- 사용자가 자신이 발견한 이스터에그와 심은 이스터에그를 구분하여 확인
- 이스터에그 목록을 시간순으로 정렬하여 최신 또는 오래된 순서로 조회
- 각 이스터에그의 제목, 메시지, 위치, 날짜, 미디어 정보를 한눈에 확인
- 이스터에그 클릭 시 상세 정보를 모달로 표시하여 발견자 목록, 미디어 콘텐츠 등을 확인

### 범위

이 명세서는 다음을 포함합니다:
- 마이페이지에서 이스터에그 영역 클릭 시 목록 페이지로 라우팅
- 이스터에그 목록 조회 및 표시 (발견한 알, 심은 알 탭 구분)
- 이스터에그 목록 정렬 기능 (최신 발견순, 오래된순)
- 이스터에그 상세 정보 모달 표시
- 심은 알의 활성/소멸 상태 구분 표시

이 명세서는 다음을 포함하지 않습니다:
- 이스터에그 수정 또는 삭제 기능
- 이스터에그 공유 기능
- 이스터에그 검색 기능

---

## 기능 요구사항

### FR-1: 마이페이지에서 이스터에그 목록 페이지로 이동

**설명**: 사용자가 마이페이지의 활동 요약 카드에서 이스터에그 영역을 클릭하면 이스터에그 목록 페이지로 이동합니다.

**수락 기준**:
- 마이페이지의 "이스터에그" 영역 클릭 시 이스터에그 목록 페이지로 라우팅됨
- 라우팅은 0.5초 이내에 완료됨
- 페이지 이동 시 이스터에그 목록이 자동으로 로드됨
- 브라우저 뒤로가기 버튼으로 마이페이지로 돌아갈 수 있음

### FR-2: 이스터에그 목록 조회 및 표시

**설명**: 사용자는 자신이 발견한 이스터에그와 심은 이스터에그를 각각 조회할 수 있습니다.

**수락 기준**:
- 페이지 진입 시 "발견한 알" 탭이 기본 선택됨
- "발견한 알" 탭 클릭 시 발견한 이스터에그 목록이 표시됨
- "심은 알" 탭 클릭 시 심은 이스터에그 목록이 표시됨
- 각 탭에는 해당 카테고리의 이스터에그 개수가 괄호 안에 표시됨 (예: "발견한 알 (12)")
- 목록이 비어있는 경우 빈 상태 메시지가 표시됨
- 목록 로딩 중에는 로딩 인디케이터가 표시됨
- API 오류 발생 시 사용자 친화적 에러 메시지가 표시되고 재시도 버튼이 제공됨

### FR-3: 이스터에그 목록 항목 정보 표시

**설명**: 각 이스터에그 목록 항목에는 제목, 메시지, 위치, 날짜, 미디어 정보가 표시됩니다.

**수락 기준**:
- 각 항목에 이스터에그 제목이 굵은 글씨로 표시됨
- 제목 아래에 메시지 내용이 작은 글씨로 표시됨 (일부만 표시 가능)
- 위치 아이콘과 함께 주소 정보가 표시됨
- 발견 날짜 또는 생성 날짜가 "YYYY-MM-DD" 형식으로 표시됨
- 이미지가 있는 경우 이미지 아이콘이 표시됨
- 오디오가 있는 경우 마이크 아이콘이 표시됨
- 비디오가 있는 경우 비디오 아이콘이 표시됨
- 심은 알의 경우 활성/소멸 상태에 따라 다른 아이콘이 표시됨 (활성: 채워진 알, 소멸: 깨진 알)

### FR-4: 심은 알의 활성/소멸 상태 구분

**설명**: 심은 알 탭에서는 활성 알과 소멸된 알을 구분하여 표시합니다.

**수락 기준**:
- "심은 알" 탭에서 "활성 알" 섹션이 먼저 표시됨
- "활성 알" 섹션에는 만료되지 않은 이스터에그만 표시됨
- "소멸된 알" 섹션이 그 아래에 표시됨
- 각 섹션에는 해당하는 이스터에그 개수가 표시됨 (예: "활성 알 (1)", "소멸된 알 (25)")
- 활성 알 항목에는 조회수(발견 횟수)가 표시됨
- 소멸된 알 항목에도 조회수가 표시됨

### FR-5: 이스터에그 목록 정렬

**설명**: 사용자는 "발견한 알" 탭에서만 이스터에그 목록을 최신 발견순 또는 오래된순으로 정렬할 수 있습니다.

**수락 기준**:
- "발견한 알" 탭에서만 목록 상단에 정렬 드롭다운 메뉴가 표시됨
- "심은 알" 탭에서는 정렬 필터가 표시되지 않음
- 기본 정렬은 "최신 발견순"임
- 드롭다운 클릭 시 "최신 발견순"과 "오래된순" 옵션이 표시됨
- 정렬 옵션 선택 시 목록이 즉시 재정렬됨
- 정렬 상태는 탭 전환 시에도 유지됨

### FR-6: 이스터에그 상세 정보 모달 표시

**설명**: 사용자가 목록의 이스터에그 항목을 클릭하면 상세 정보가 모달로 표시됩니다.

**수락 기준**:
- 이스터에그 항목 클릭 시 상세 정보 모달이 표시됨
- 모달은 0.3초 이내에 표시됨
- 모달 배경에 반투명 오버레이가 적용됨
- 모달 상단 우측에 닫기 버튼(X)이 표시됨
- 모달 상단에 작성자 프로필 이미지가 원형으로 표시됨
- FOUND 타입인 경우: "작성자 닉네임님의 소중한 추억을 N번째로 찾으셨군요!" 메시지 표시
- PLANTED 타입인 경우: "다른 사람들이 발견한 내 이스터에그를 확인해보세요!" 메시지 표시
- 위치 정보가 배지 형태로 중앙 정렬되어 표시됨
- FOUND 타입인 경우 발견 날짜와 시간이 위치 배지 아래에 표시됨
- 메인 컨텐츠 카드에 제목, 날짜 배지, 메시지가 표시됨
- 이미지가 있는 경우 이미지가 표시됨
- 오디오가 있는 경우 HTML5 오디오 플레이어가 표시되고 재생 가능함
- 비디오가 있는 경우 HTML5 비디오 플레이어가 표시되고 재생 가능함
- PLANTED 타입인 경우에만 "발견한 사람" 섹션이 표시됨 (발견한 사람 수와 각 발견자의 프로필 이미지, 닉네임, 발견 시간)
- 발견한 사람이 없는 경우 "아직 발견한 사람이 없습니다" 메시지 표시
- 모달은 스크롤 가능하며 최대 높이는 화면의 80%로 제한됨

### FR-7: 상세 모달 닫기

**설명**: 사용자는 여러 방법으로 상세 모달을 닫을 수 있습니다.

**수락 기준**:
- 모달 상단의 닫기 버튼(X) 클릭 시 모달이 닫힘
- 모달 배경 오버레이 클릭 시 모달이 닫힘
- ESC 키 입력 시 모달이 닫힘
- 모달이 닫힐 때 0.3초 이내에 사라짐
- 모달이 닫힌 후 목록 페이지로 돌아감

### FR-8: 페이지 요약 정보 표시

**설명**: 페이지 상단에는 이스터에그 요약 정보가 표시됩니다.

**수락 기준**:
- 페이지 제목 "이스터에그"가 표시됨
- 제목 아래에 "발견한 알 X개 · 심은 알 Y개 (활성 A/B)" 형식의 요약 정보가 표시됨
- 심은 알의 경우 활성 알 개수와 전체 슬롯 개수가 표시됨
- 페이지 상단 우측에 닫기 버튼이 표시되어 마이페이지로 돌아갈 수 있음

---

## 사용자 시나리오

### 시나리오 1: 발견한 이스터에그 목록 확인

1. 사용자가 마이페이지에 접속함
2. 활동 요약 카드에서 "이스터에그" 영역을 클릭함
3. 이스터에그 목록 페이지로 이동함
4. "발견한 알" 탭이 기본 선택되어 있고, 발견한 이스터에그 목록이 표시됨
5. 각 항목에는 제목, 메시지, 위치, 발견 날짜가 표시됨
6. 사용자가 목록을 스크롤하여 모든 발견한 이스터에그를 확인함

### 시나리오 2: 심은 이스터에그 목록 확인

1. 사용자가 이스터에그 목록 페이지에 있음
2. "심은 알" 탭을 클릭함
3. "활성 알" 섹션이 먼저 표시되고, 활성 상태인 이스터에그가 표시됨
4. 활성 알 아래에 "소멸된 알" 섹션이 표시되고, 만료된 이스터에그가 표시됨
5. 각 항목에는 활성/소멸 상태를 나타내는 아이콘이 표시됨
6. 활성 알 항목에는 조회수(발견 횟수)가 표시됨

### 시나리오 3: 이스터에그 상세 정보 확인

1. 사용자가 이스터에그 목록 페이지에서 특정 이스터에그 항목을 클릭함
2. 상세 정보 모달이 표시됨
3. 모달에서 이스터에그의 제목, 메시지, 이미지, 오디오를 확인함
4. 오디오 플레이어를 사용하여 오디오를 재생함
5. "발견한 사람" 섹션에서 이 이스터에그를 발견한 사람들의 목록을 확인함
6. 각 발견자의 프로필 이미지, 닉네임, 발견 시간을 확인함
7. 모달 상단의 닫기 버튼을 클릭하여 모달을 닫음
8. 목록 페이지로 돌아감

### 시나리오 4: 목록 정렬 변경

1. 사용자가 이스터에그 목록 페이지에 있음
2. 목록 상단의 정렬 드롭다운을 클릭함
3. "오래된순" 옵션을 선택함
4. 목록이 즉시 오래된 순서로 재정렬됨
5. 사용자가 "심은 알" 탭으로 전환함
6. 정렬 상태가 유지되어 "심은 알" 목록도 오래된순으로 표시됨

### 시나리오 5: 빈 목록 상태 처리

1. 사용자가 마이페이지에서 이스터에그 영역을 클릭함
2. 이스터에그 목록 페이지로 이동함
3. 사용자가 아직 발견한 이스터에그가 없는 경우
4. "발견한 알" 탭에 빈 상태 메시지가 표시됨 (예: "아직 발견한 이스터에그가 없습니다")
5. 사용자가 "심은 알" 탭으로 전환함
6. 심은 이스터에그도 없는 경우 빈 상태 메시지가 표시됨

---

## 성공 기준

### SC-1: 페이지 로딩 성능

- 이스터에그 목록 페이지 진입 후 1초 이내에 목록이 표시됨
- 목록 항목 클릭 후 0.5초 이내에 상세 모달이 표시됨
- 이미지 및 미디어 콘텐츠는 점진적 로딩으로 초기 렌더링을 방해하지 않음

### SC-2: 사용자 경험 품질

- 모든 인터랙션(탭 전환, 정렬, 모달 열기/닫기)에 즉각적인 시각적 피드백이 제공됨
- 애니메이션은 60fps로 부드럽게 동작함
- 터치 타겟 크기가 최소 44x44px 이상임
- 모바일 화면(375px 너비 기준)에서 모든 콘텐츠가 적절히 표시됨

### SC-3: 데이터 정확성

- 표시된 이스터에그 개수가 실제 데이터와 일치함
- 목록 정렬이 올바르게 작동함
- 활성/소멸 상태 구분이 정확함
- 상세 모달의 정보가 실제 데이터와 일치함

### SC-4: 오류 처리

- 네트워크 오류 발생 시 사용자 친화적 메시지가 표시되고 재시도 옵션이 제공됨
- 빈 목록 상태가 명확하게 표시됨
- 로딩 중 상태가 명확하게 표시됨
- API 오류 발생 시 사용자가 다음 동작을 취할 수 있는 안내가 제공됨

### SC-5: 접근성

- 키보드만으로 모든 기능 사용 가능 (탭 전환, 정렬, 모달 열기/닫기)
- 스크린 리더가 모든 콘텐츠를 올바르게 읽음
- 모든 인터랙티브 요소에 적절한 aria-label이 제공됨
- 색상 대비가 WCAG 2.1 AA 레벨을 준수함

---

## 핵심 엔티티

### 이스터에그 목록 항목

**설명**: 목록에 표시되는 각 이스터에그의 요약 정보

**속성**:
- `eggId` (string): 이스터에그 고유 식별자
- `type` (string): 이스터에그 유형 ("FOUND" 또는 "PLANTED")
- `title` (string): 이스터에그 제목
- `message` (string): 이스터에그 메시지
- `location` (object): 위치 정보
  - `address` (string): 주소
  - `latitude` (number): 위도
  - `longitude` (number): 경도
- `createdAt` (string): 생성 날짜 (ISO 8601)
- `foundAt` (string): 발견 날짜 (ISO 8601, 발견한 알인 경우)
- `expiredAt` (string): 만료 날짜 (ISO 8601, 심은 알인 경우)
- `discoveredCount` (number): 발견 횟수
- `hasImage` (boolean): 이미지 포함 여부
- `hasAudio` (boolean): 오디오 포함 여부
- `hasVideo` (boolean): 비디오 포함 여부
- `isActive` (boolean): 활성 상태 여부 (심은 알인 경우)

### 이스터에그 상세 정보

**설명**: 모달에 표시되는 이스터에그의 상세 정보

**속성**:
- `id` (string): 이스터에그 고유 식별자
- `title` (string): 제목
- `content` (string): 내용
- `open_at` (string): 공개 날짜 (ISO 8601)
- `created_at` (string): 생성 날짜 (ISO 8601)
- `author` (object): 작성자 정보
  - `id` (string): 작성자 ID
  - `nickname` (string): 닉네임
  - `profile_img` (string): 프로필 이미지 URL
- `location` (object): 위치 정보
  - `address` (string): 주소
  - `latitude` (number): 위도
  - `longitude` (number): 경도
- `media_items` (array): 미디어 항목 목록
  - `media_id` (string): 미디어 ID
  - `type` (string): 미디어 유형 ("IMAGE", "AUDIO", "VIDEO")
  - `object_key` (string): 미디어 파일 경로
- `viewers` (array): 발견자 목록
  - `id` (string): 발견자 ID
  - `nickname` (string): 닉네임
  - `profile_img` (string): 프로필 이미지 URL
  - `viewed_at` (string): 발견 시간 (ISO 8601)

---

## 비기능 요구사항

### NFR-1: 성능

- 목록 페이지 초기 로딩 시간이 1초 이내
- 목록 스크롤이 60fps로 부드럽게 동작
- 이미지 및 미디어 콘텐츠는 지연 로딩(lazy loading) 적용
- 모달 열기/닫기 애니메이션이 60fps로 동작

### NFR-2: 호환성

- iOS Safari, Android Chrome 최신 2개 버전 지원
- 다양한 화면 크기(320px ~ 428px 너비)에서 정상 동작
- 터치 및 마우스 인터랙션 모두 지원

### NFR-3: 유지보수성

- 기존 공통 컴포넌트(Modal, Button 등) 재사용
- 디자인 토큰 기반 스타일링
- 컴포넌트 재사용 가능한 구조
- 타입 안정성 보장 (TypeScript)

---

## 제약사항

### 기술적 제약사항

- Next.js App Router 구조 내에서 구현
- 클라이언트 컴포넌트로 구현 필요 ('use client' 지시어 사용)
- 기존 API 클라이언트 구조 준수
- 기존 공통 컴포넌트 API 및 동작 방식 준수

### 디자인 제약사항

- 제공된 이미지 디자인 스펙 준수 필수
- 기존 디자인 토큰 외 새로운 색상값 사용 금지
- tailwind.config.js 수정 금지 (기존 토큰 사용)

### 비즈니스 제약사항

- 기존 Expo Go 코드를 웹 환경에 맞게 리팩토링
- API 응답 구조 변경 시 하위 호환성 고려
- 향후 기능 확장을 위한 확장 가능한 구조

---

## 가정사항

### 디자인 가정

- 제공된 이미지가 최종 승인된 UI 디자인임
- 디자인에 명시된 모든 아이콘이 @remixicon/react 라이브러리에 있음
- 디자인 토큰이 이미 프로젝트에 정의되어 있음

### 기술 가정

- API 엔드포인트가 정상 동작함
- API 응답 구조가 제공된 예시와 일치함
- 기존 공통 컴포넌트(Modal, Button 등)가 정상 동작함
- 브라우저가 필요한 미디어 API를 지원함

### 사용자 가정

- 사용자가 모바일 디바이스를 사용함
- 사용자가 터치 인터랙션에 익숙함
- 사용자가 모달 UI 패턴을 이해함

---

## 엣지 케이스

### EC-1: 네트워크 지연

**상황**: 목록 로딩 중 네트워크 지연 발생

**처리**:
- 로딩 인디케이터 표시
- 5초 이상 지연 시 재시도 옵션 제공
- 에러 발생 시 사용자 친화적 메시지 표시

### EC-2: 빈 목록

**상황**: 사용자가 발견하거나 심은 이스터에그가 없음

**처리**:
- 빈 상태 메시지 표시
- 적절한 안내 문구 제공 (예: "아직 발견한 이스터에그가 없습니다")

### EC-3: 미디어 로딩 실패

**상황**: 이미지 또는 오디오 파일 로딩 실패

**처리**:
- 미디어 로딩 실패 시 플레이스홀더 표시
- 사용자에게 미디어를 불러올 수 없음을 알림
- 재시도 옵션 제공

### EC-4: 매우 긴 제목 또는 메시지

**상황**: 이스터에그 제목이나 메시지가 매우 긺

**처리**:
- 제목은 최대 1줄로 표시하고 말줄임표(...) 처리
- 메시지는 최대 2줄로 표시하고 말줄임표 처리
- 상세 모달에서는 전체 내용 표시

### EC-5: 동시에 여러 모달 열기 시도

**상황**: 사용자가 빠르게 여러 이스터에그를 클릭

**처리**:
- 한 번에 하나의 모달만 표시
- 새로운 모달 열기 시 기존 모달 자동 닫기
- 클릭 디바운싱 적용

---

## 참고사항

### API 엔드포인트

- `GET /api/capsules/my-eggs`: 내 이스터에그 목록 조회
- `GET /api/capsules/{id}/detail`: 알 상세 정보 조회

### 관련 컴포넌트

- `src/components/Mypage/`: 마이페이지 컴포넌트
- `src/components/my-egg-list/`: 이스터에그 목록 Feature Container
  - `components/header/`: 헤더 컴포넌트 (제목, 닫기 버튼, 요약 정보)
  - `components/tab/`: 탭 컴포넌트 (발견한 알, 심은 알)
  - `components/filter/`: 정렬 필터 컴포넌트 (최신발견순, 오래된순)
  - `components/item/`: 이스터에그 목록 항목 컴포넌트
  - `components/item-list/`: 아이템 리스트 컴포넌트 (활성/소멸 구분)
  - `components/modal/`: 이스터에그 상세 모달 컴포넌트
  - `hooks/useMyEggList.ts`: 비즈니스 로직 훅
- `src/commons/components/modal/`: 모달 공통 컴포넌트
- `src/commons/components/button/`: 버튼 공통 컴포넌트

### 구현 단계 제안

이 명세서는 구현 세부사항을 포함하지 않지만, 다음 단계인 기술 계획 수립 시 다음 단계들을 고려할 것을 권장합니다:

1. **Phase 1**: 페이지 라우팅 및 기본 레이아웃 구성
2. **Phase 2**: 이스터에그 목록 조회 및 표시 (탭 기능 포함)
3. **Phase 3**: 목록 정렬 기능 구현
4. **Phase 4**: 상세 모달 구현
5. **Phase 5**: 활성/소멸 상태 구분 및 빈 상태 처리
6. **Phase 6**: 테스트 및 최적화

---

**문서 버전**: 1.0.0  
**작성일**: 2026-01-28  
**다음 단계**: `/speckit.plan` 명령어로 기술 계획 수립
