# 기능 명세서: 이스터에그 바텀시트

## 개요

홈 화면의 FAB(Floating Action Button)에서 이스터에그 옵션을 선택하면, 사용자가 이스터에그 생성 옵션을 선택할 수 있는 바텀시트가 표시됩니다. 이 바텀시트는 드래그 가능하며, 사용자가 직관적으로 옵션을 선택하고 다음 단계로 진행할 수 있도록 합니다.

### 배경

현재 FAB 버튼에서 이스터에그를 선택하면 콘솔 로그만 출력되고 실제 동작이 없습니다. 사용자가 이스터에그 생성 프로세스를 시작할 수 있도록, 선택 가능한 옵션을 제공하는 인터페이스가 필요합니다.

### 목적

- 사용자가 FAB 버튼에서 이스터에그 생성을 선택했을 때 명확한 피드백 제공
- 이스터에그 생성의 다양한 옵션을 직관적으로 표시
- 모바일 친화적인 인터랙션 제공 (드래그 가능한 바텀시트)

## 기능 요구사항

### FR-1: FAB 버튼 이스터에그 선택 시 바텀시트 표시

**설명**: 사용자가 홈 화면의 FAB 버튼을 열고 "이스터에그" 옵션을 선택하면, 하단에서 바텀시트가 올라옵니다.

**수락 기준**:
- FAB 버튼의 "이스터에그" 옵션 클릭 시 바텀시트가 0.3초 이내에 표시됨
- 바텀시트는 화면 하단에서 위로 슬라이드 애니메이션과 함께 나타남
- 바텀시트가 표시되는 동안 배경에 반투명 오버레이가 적용됨
- 바텀시트 표시 시 FAB 버튼의 확장 메뉴는 자동으로 닫힘

### FR-2: 바텀시트 높이 및 드래그 동작

**설명**: 바텀시트는 화면 전체 높이의 70%까지 올라올 수 있으며, 사용자가 드래그하여 높이를 조절할 수 있습니다.

**수락 기준**:
- 바텀시트의 초기 표시 높이는 컨텐츠에 맞게 자동 조정됨
- 바텀시트는 최대 화면 높이의 70%까지 확장 가능
- 사용자가 바텀시트 상단의 핸들을 드래그하여 높이 조절 가능
- 드래그 동작이 부드럽고 자연스러움 (60fps 유지)
- 바텀시트를 아래로 충분히 드래그하면 닫힘

### FR-3: 바텀시트 컨텐츠 구성

**설명**: 바텀시트는 Figma 디자인에 따라 제목, 설명, 선택 옵션 버튼들을 포함합니다.

**수락 기준**:
- 바텀시트 상단에 드래그 핸들이 표시됨
- 제목과 설명 텍스트가 명확하게 표시됨
- 선택 가능한 옵션들이 버튼 형태로 제공됨
- 모든 텍스트는 Figma 디자인의 타이포그래피 스타일을 따름
- 버튼 간격과 패딩은 Figma 디자인 스펙을 준수함

### FR-4: 바텀시트 하단 버튼 영역

**설명**: 바텀시트 하단에는 취소와 확인 버튼이 고정되어 표시됩니다.

**수락 기준**:
- 하단에 DualButton 컴포넌트가 고정 배치됨
- 취소 버튼 클릭 시 바텀시트가 닫힘
- 확인 버튼 클릭 시 선택된 옵션으로 다음 단계 진행
- 옵션이 선택되지 않은 경우 확인 버튼이 비활성화됨
- 버튼 영역은 스크롤되지 않고 항상 하단에 고정됨

### FR-5: 바텀시트 닫기 동작

**설명**: 사용자는 여러 방법으로 바텀시트를 닫을 수 있습니다.

**수락 기준**:
- 배경 오버레이 클릭 시 바텀시트가 닫힘
- 취소 버튼 클릭 시 바텀시트가 닫힘
- ESC 키 입력 시 바텀시트가 닫힘
- 바텀시트를 아래로 드래그하여 닫을 수 있음
- 닫힐 때 아래로 슬라이드 애니메이션 적용

### FR-6: 접근성 및 키보드 네비게이션

**설명**: 바텀시트는 키보드와 스크린 리더 사용자를 위한 접근성을 제공합니다.

**수락 기준**:
- 바텀시트가 열리면 포커스가 바텀시트 내부로 이동
- Tab 키로 바텀시트 내 모든 인터랙티브 요소 탐색 가능
- 바텀시트가 닫히면 포커스가 이전 위치(FAB 버튼)로 복원됨
- 스크린 리더가 바텀시트의 역할과 상태를 올바르게 읽음
- 모든 버튼에 적절한 aria-label 제공

## 사용자 시나리오

### 시나리오 1: 이스터에그 생성 시작

1. 사용자가 홈 화면에서 우측 하단의 FAB 버튼을 탭함
2. FAB 메뉴가 확장되어 "이스터에그"와 "타임캡슐" 옵션이 표시됨
3. 사용자가 "이스터에그" 옵션을 탭함
4. FAB 메뉴가 닫히고, 하단에서 바텀시트가 올라옴
5. 바텀시트에 이스터에그 생성 옵션들이 표시됨
6. 사용자가 원하는 옵션을 선택함
7. 사용자가 "확인" 버튼을 탭함
8. 바텀시트가 닫히고 선택된 옵션으로 이스터에그 생성 프로세스가 시작됨

### 시나리오 2: 바텀시트 드래그 조작

1. 사용자가 이스터에그 바텀시트를 연 상태
2. 사용자가 바텀시트 상단의 핸들을 위로 드래그함
3. 바텀시트가 화면 높이의 70%까지 확장됨
4. 사용자가 핸들을 아래로 드래그함
5. 바텀시트가 초기 높이로 축소됨
6. 사용자가 핸들을 빠르게 아래로 스와이프함
7. 바텀시트가 닫히고 배경 오버레이가 사라짐

### 시나리오 3: 바텀시트 취소

1. 사용자가 이스터에그 바텀시트를 연 상태
2. 사용자가 마음을 바꿔 생성을 취소하기로 결정함
3. 사용자가 "취소" 버튼을 탭함 (또는 배경을 탭함)
4. 바텀시트가 아래로 슬라이드되며 닫힘
5. 홈 화면으로 돌아가고 FAB 버튼이 다시 표시됨

### 시나리오 4: 키보드 네비게이션

1. 키보드 사용자가 Tab 키로 FAB 버튼에 포커스를 이동함
2. Enter 키로 FAB 메뉴를 열고, Tab 키로 "이스터에그" 옵션으로 이동함
3. Enter 키로 이스터에그 옵션을 선택함
4. 바텀시트가 열리고 포커스가 바텀시트 내부로 이동함
5. Tab 키로 옵션 버튼들을 탐색하고 선택함
6. Tab 키로 "확인" 버튼으로 이동하여 Enter 키로 선택함
7. 바텀시트가 닫히고 포커스가 FAB 버튼으로 복원됨

## 성공 기준

### SC-1: 사용자 경험 품질

- 바텀시트 열기/닫기 애니메이션이 0.3초 이내에 완료됨
- 드래그 동작이 60fps로 부드럽게 동작함
- 모든 인터랙션에 즉각적인 시각적 피드백 제공
- 터치 타겟 크기가 최소 44x44px 이상임

### SC-2: 기능 완성도

- 바텀시트가 화면 높이의 70%까지 정확하게 확장됨
- 모든 닫기 방법(오버레이, 취소 버튼, ESC, 드래그)이 정상 작동함
- 옵션 선택 상태가 시각적으로 명확하게 표시됨
- 확인 버튼이 선택 상태에 따라 올바르게 활성화/비활성화됨

### SC-3: 접근성 준수

- WCAG 2.1 AA 레벨 준수
- 키보드만으로 모든 기능 사용 가능
- 스크린 리더가 모든 컨텐츠를 올바르게 읽음
- 포커스 관리가 예측 가능하고 논리적임

### SC-4: 디자인 일관성

- Figma 디자인 스펙과 100% 일치
- 기존 디자인 토큰(색상, 타이포그래피, 간격) 사용
- 공통 컴포넌트(BottomSheet, DualButton) 재사용
- 다른 바텀시트들과 동일한 UX 패턴 적용

## 핵심 엔티티

### BottomSheet State

**설명**: 바텀시트의 표시 상태 및 컨텐츠 정보

**속성**:
- `isOpen` (boolean): 바텀시트 표시 여부
- `selectedOption` (string | null): 사용자가 선택한 옵션 ID
- `height` (number): 현재 바텀시트 높이 (px)
- `isDragging` (boolean): 드래그 중인지 여부

### EasterEgg Option

**설명**: 바텀시트에 표시되는 이스터에그 생성 옵션

**속성**:
- `id` (string): 옵션 고유 식별자
- `label` (string): 옵션 표시 텍스트
- `description` (string): 옵션 설명
- `icon` (string): @remixicon/react 아이콘 이름

## 비기능 요구사항

### NFR-1: 성능

- 바텀시트 애니메이션이 60fps로 동작
- 드래그 인터랙션의 응답 시간이 16ms 이하
- 바텀시트 렌더링 시간이 100ms 이하

### NFR-2: 호환성

- iOS Safari, Android Chrome 최신 2개 버전 지원
- 다양한 화면 크기(320px ~ 428px 너비)에서 정상 동작
- 다크 모드 지원 (향후 추가 시)

### NFR-3: 유지보수성

- 기존 BottomSheet 공통 컴포넌트 활용
- 기존 DualButton 공통 컴포넌트 활용
- Figma 디자인 토큰 기반 스타일링
- 컴포넌트 재사용 가능한 구조

## 제약사항

### 기술적 제약사항

- 기존 BottomSheet 컴포넌트의 API 및 동작 방식 준수
- Next.js App Router 구조 내에서 구현
- 클라이언트 컴포넌트로 구현 필요 ('use client' 지시어 사용)

### 디자인 제약사항

- Figma 디자인 스펙 준수 필수
- 기존 디자인 토큰 외 새로운 색상값 사용 금지
- tailwind.config.js 수정 금지

### 비즈니스 제약사항

- 이스터에그 생성 프로세스의 첫 단계로 동작
- 타임캡슐 바텀시트와 일관된 UX 제공
- 향후 추가될 옵션을 위한 확장 가능한 구조

## 가정사항

### 디자인 가정

- Figma 디자인이 최종 승인된 상태임
- 디자인에 명시된 모든 에셋(아이콘, 이미지)이 제공됨
- 아이콘은 @remixicon/react 라이브러리 사용 (새로운 아이콘 패키지 추가 금지)
- 디자인 토큰이 이미 프로젝트에 정의되어 있음

### 기술 가정

- BottomSheet 공통 컴포넌트가 드래그 기능을 지원함
- DualButton 공통 컴포넌트가 정상 동작함
- 카카오 지도 API가 정상적으로 로드됨

### 사용자 가정

- 사용자가 모바일 디바이스를 사용함
- 사용자가 터치 인터랙션에 익숙함
- 사용자가 바텀시트 UI 패턴을 이해함

## 엣지 케이스

### EC-1: 네트워크 지연

**상황**: 바텀시트 컨텐츠 로딩 중 네트워크 지연 발생

**처리**:
- 로딩 스피너 표시
- 3초 이상 지연 시 재시도 옵션 제공
- 에러 발생 시 사용자 친화적 메시지 표시

### EC-2: 빠른 연속 클릭

**상황**: 사용자가 FAB 버튼이나 옵션을 빠르게 여러 번 클릭

**처리**:
- 디바운싱 적용하여 중복 실행 방지
- 바텀시트가 열리는 동안 FAB 버튼 비활성화
- 애니메이션 진행 중 추가 인터랙션 무시

### EC-3: 작은 화면 크기

**상황**: 매우 작은 화면(320px 너비 이하)에서 사용

**처리**:
- 바텀시트 최소 높이 보장
- 컨텐츠가 잘리지 않도록 스크롤 가능 영역 제공
- 버튼 크기 유지하되 텍스트는 줄바꿈 허용

### EC-4: 드래그 중 화면 회전

**상황**: 사용자가 바텀시트를 드래그하는 중 화면 회전

**처리**:
- 드래그 상태 초기화
- 새로운 화면 크기에 맞게 바텀시트 높이 재계산
- 선택된 옵션 상태는 유지

### EC-5: 포커스 트랩 실패

**상황**: 바텀시트가 열렸지만 포커스가 외부로 이동

**처리**:
- 포커스 트랩 재적용
- 바텀시트 내부로 강제 포커스 이동
- 접근성 경고 로그 기록

## 참고사항

### Figma 디자인 링크

- 바텀시트 초기 상태: https://www.figma.com/design/k7IWFISJsHIQ4g6FoAZqup/%ED%83%80%EC%9E%84%EC%BA%A1%EC%8A%90---%EC%9D%B4%EC%8A%A4%ED%84%B0%EC%97%90%EA%B7%B8?node-id=599-5186&m=dev
- 바텀시트 확장 상태: https://www.figma.com/design/k7IWFISJsHIQ4g6FoAZqup/%ED%83%80%EC%9E%84%EC%BA%A1%EC%8A%90---%EC%9D%B4%EC%8A%A4%ED%84%B0%EC%97%90%EA%B7%B8?node-id=599-5362&m=dev

### 관련 컴포넌트

- `src/commons/components/bottom-sheet/`: 바텀시트 공통 컴포넌트
- `src/commons/components/dual-button/`: 듀얼 버튼 공통 컴포넌트
- `src/components/home/components/fab-button/`: FAB 버튼 컴포넌트

### 구현 단계 제안

이 명세서는 구현 세부사항을 포함하지 않지만, 다음 단계인 기술 계획 수립 시 다음 단계들을 고려할 것을 권장합니다:

1. **Phase 1**: 기본 바텀시트 통합 및 상태 관리
2. **Phase 2**: Figma 디자인 기반 컨텐츠 구현
3. **Phase 3**: 드래그 인터랙션 구현
4. **Phase 4**: 접근성 및 키보드 네비게이션
5. **Phase 5**: 테스트 및 최적화

---

**문서 버전**: 1.0.0  
**작성일**: 2026-01-26  
**다음 단계**: `/speckit.plan` 명령어로 기술 계획 수립
