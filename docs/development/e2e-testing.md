# E2E í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

Playwright ê¸°ë°˜ E2E í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë°©ë²•ê³¼ í˜„ì¬ ìƒíƒœë¥¼ ì •ë¦¬í•©ë‹ˆë‹¤.

## ì‹¤í–‰ ë°©ë²•

### ì‚¬ì „ ì¡°ê±´

- **ê°œë°œ ì„œë²„**: `npm run dev`ë¡œ `http://localhost:8081`ì´ ë–  ìˆì–´ì•¼ í•©ë‹ˆë‹¤.  
  Playwright ì„¤ì •(`reuseExistingServer: true`)ìœ¼ë¡œ ì´ë¯¸ ë–  ìˆìœ¼ë©´ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.
- **í™˜ê²½ ë³€ìˆ˜**: `.env.local`ì— `NEXT_PUBLIC_API_BASE_URL` ë“±ì´ ì„¤ì •ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.

### ì „ì²´ E2Eë§Œ ì‹¤í–‰

```bash
npm run test:e2e
```

ë˜ëŠ”

```bash
npx playwright test tests/e2e
```

### íŠ¹ì • ë””ë ‰í„°ë¦¬ë§Œ ì‹¤í–‰

```bash
# Health ì²´í¬ë§Œ (ë¡œê·¸ì¸ ë¶ˆí•„ìš”, ë¹ ë¦„)
npm run test:e2e:health

# ë¡œê·¸ì¸ E2Eë§Œ
npx playwright test tests/e2e/login

# ì¹œêµ¬ ê´€ë¦¬ E2Eë§Œ
npx playwright test tests/e2e/friend-management

# ë§ˆì´í˜ì´ì§€Â·ë¡œê·¸ì•„ì›ƒ E2Eë§Œ
npx playwright test tests/e2e/mypage
```

### UI ëª¨ë“œ / ë””ë²„ê·¸

```bash
npm run test:ui      # Playwright UIë¡œ ì‹¤í–‰
npm run test:debug   # ë””ë²„ê·¸ ëª¨ë“œ
npm run test:headed  # ë¸Œë¼ìš°ì € ì°½ ë³´ì´ë©´ì„œ ì‹¤í–‰
```

### ë¦¬í¬í„°

- ê¸°ë³¸: HTML ë¦¬í¬í„° â†’ ì‹¤í–‰ í›„ `npx playwright show-report`ë¡œ í™•ì¸
- í•œ ì¤„ ìš”ì•½: `npx playwright test tests/e2e --reporter=line`

## E2E í…ŒìŠ¤íŠ¸ êµ¬ì„± (tests/e2e)

| ë””ë ‰í„°ë¦¬ | ì„¤ëª… | ë¡œê·¸ì¸ í•„ìš” |
|----------|------|-------------|
| `health/` | API Health Check | âŒ |
| `login/` | ë¡œê·¸ì¸ APIÂ·í”Œë¡œìš° | âŒ (API í…ŒìŠ¤íŠ¸) / âœ… (í”Œë¡œìš°) |
| `friend-management/` | ì¹œêµ¬ ëª©ë¡Â·ì¶”ê°€Â·ì‚­ì œ | âœ… |
| `mypage/` | ë§ˆì´í˜ì´ì§€(/profile)Â·ë¡œê·¸ì•„ì›ƒ | âŒ (ë¹„ë¡œê·¸ì¸ ë¦¬ë‹¤ì´ë ‰íŠ¸) / âœ… (UIÂ·ë¡œê·¸ì•„ì›ƒ) |
| `kakao-map/` | ì§€ë„ ë Œë”Â·FABÂ·ìŠ¬ë¡¯ | âœ… |
| `easter-egg/` | ì´ìŠ¤í„°ì—ê·¸ í¼ ì œì¶œ | âœ… |
| `easter-egg-map-display/` | ì§€ë„ ìº¡ìŠ ë§ˆì»¤Â·ëª¨ë‹¬ | âœ… |
| `my-egg-list/` | ë‚´ ì•Œ ëª©ë¡Â·íƒ­Â·ëª¨ë‹¬ | âœ… |
| `slot-management/` | ìŠ¬ë¡¯ ê´€ë¦¬ | âœ… |
| `payment/` | ê²°ì œÂ·ì½œë°± | âœ… |
| `timecapsule/` | íƒ€ì„ìº¡ìŠ ìƒì„±Â·ì£¼ë¬¸ | âœ… |
| `waiting-room/` | ëŒ€ê¸°ì‹¤Â·ì½˜í…ì¸  ì‘ì„± | âœ… |
| `room/` | ë°© ì´ˆëŒ€ API | âœ… |

## í˜„ì¬ í™•ì¸ëœ ê²°ê³¼ (2025-01 ê¸°ì¤€)

### âœ… í†µê³¼

- **tests/e2e/health** (8ê°œ): ëª¨ë‘ í†µê³¼  
  - API ì—”ë“œí¬ì¸íŠ¸Â·health ì‘ë‹µÂ·í˜•ì‹Â·ì‘ë‹µ ì‹œê°„Â·ì—ëŸ¬ ì²˜ë¦¬

### âš ï¸ ë¡œê·¸ì¸ ì˜ì¡´ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì›ì¸

ë‹¤ìŒê³¼ ê°™ì€ í…ŒìŠ¤íŠ¸ë“¤ì€ **ì‹¤ì œ ë°±ì—”ë“œ ë¡œê·¸ì¸**ì´ í•„ìš”í•©ë‹ˆë‹¤.

- **ë¡œê·¸ì¸ ì‹¤íŒ¨ (401 "ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.")**
  - `login-flow.e2e.spec.ts`: ì „í™”ë²ˆí˜¸ `01012345678` / ë¹„ë°€ë²ˆí˜¸ `Password123!` ì‚¬ìš©
  - `friend-management`, `mypage`, `my-egg-list`, `easter-egg-map-display` ë“±: `.env.local`ì˜  
    `NEXT_PUBLIC_PHONE_NUMBER`, `NEXT_PUBLIC_PASSWORD` ì‚¬ìš©
  - ë°±ì—”ë“œì— í•´ë‹¹ ê³„ì •ì´ ì—†ê±°ë‚˜, ë¹„ë°€ë²ˆí˜¸ê°€ ë‹¤ë¥´ë©´ 401ë¡œ ì‹¤íŒ¨í•©ë‹ˆë‹¤.

**ì¡°ì¹˜:**

1. ë°±ì—”ë“œì— E2Eìš© í…ŒìŠ¤íŠ¸ ê³„ì •ì„ ë§Œë“¤ê³ , ê·¸ ê³„ì • ì •ë³´ë¥¼ í…ŒìŠ¤íŠ¸/í™˜ê²½ë³€ìˆ˜ì— ë§ì¶¥ë‹ˆë‹¤.
2. ë˜ëŠ” ë¡œê·¸ì¸ í”Œë¡œìš°ë§Œ Mock/MSWë¡œ ë¶„ë¦¬í•˜ê³ , API ì—°ë™ E2EëŠ” ë³„ë„ ìŠ¤ìœ„íŠ¸ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤.

### ğŸ”§ ìˆ˜ì •ëœ ë²„ê·¸

- **api-client ì—ëŸ¬ ë¡œê¹…**: `FormData` ìš”ì²­ ì‹¤íŒ¨ ì‹œ `JSON.parse(error.config.data)`ë¡œ ì¸í•œ  
  `SyntaxError: "[object FormData]" is not valid JSON` ë°œìƒ â†’  
  FormData/ë¹„ë¬¸ìì—´ ë°ì´í„°ëŠ” ë¡œê·¸ ì‹œ `[FormData]` ë“±ìœ¼ë¡œ ì•ˆì „í•˜ê²Œ í‘œì‹œí•˜ë„ë¡ ìˆ˜ì •ë¨.

## ë¹ ë¥´ê²Œ í™•ì¸í•  ë•Œ

ë¡œê·¸ì¸ ì—†ì´ ê²°ê³¼ë§Œ ë¹ ë¥´ê²Œ ë³´ë ¤ë©´:

```bash
npm run test:e2e:health
```

ë¡œê·¸ì¸ ì˜ì¡´ E2Eê¹Œì§€ í¬í•¨í•œ ì „ì²´ ê²°ê³¼ë¥¼ ë³´ë ¤ë©´ (ì‹œê°„ ë‹¤ì†Œ ì†Œìš”):

```bash
npm run test:e2e -- --reporter=line
```
