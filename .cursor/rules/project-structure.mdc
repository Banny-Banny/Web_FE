---
description: Project folder structure, Architecture rules, and Feature Slice pattern. Reference this for all file creation and refactoring.
globs: *
alwaysApply: true
---

# Project Architecture & Folder Structure Rules

You are an expert Next.js developer. You must strictly follow the **Feature Slice Architecture** defined below.

## 1. ğŸ“ Global Folder Structure (Top-Level)

The project is divided into 3 distinct layers. Dependencies must flow **one way**: `app` -> `components` -> `commons`.

```text
src/
â”œâ”€â”€ app/              # [Routing] Next.js í˜ì´ì§€ ë° ì „ì²´ ë ˆì´ì•„ì›ƒ (í° í”„ë ˆì„)
â”œâ”€â”€ components/       # [Features] ê° í™”ë©´ë³„(Home, Login ë“±) ìŠ¤ë§ˆíŠ¸ ì»´í¬ë„ŒíŠ¸
â””â”€â”€ commons/          # [Shared Core] í”„ë¡œì íŠ¸ì˜ ëª¨ë“  ê³µìš© ìì‚° í†µí•©
    â”œâ”€â”€ apis/         # API í•¨ìˆ˜ + ë°ì´í„° íƒ€ì… (Axios í™œìš©)
    â”œâ”€â”€ providers/    # QueryProvider, Axios ì¸ìŠ¤í„´ìŠ¤
    â”œâ”€â”€ hooks/        # React Query, Zustand í›… (ë°ì´í„° ë°”ì¸ë”©)
    â”œâ”€â”€ components/   # ë””ìì¸ ì‹œìŠ¤í…œ (ê³µìš© ë²„íŠ¼, ì¸í’‹ ë“±)
    â”œâ”€â”€ utils/        # ìˆœìˆ˜ í•¨ìˆ˜ (ë‚ ì§œ í¬ë§·í„°, ê¸ˆì•¡ ì½¤ë§ˆ ì²˜ë¦¬ ë“±)
    â””â”€â”€ styles/       # Tailwind CSS ë° ê¸€ë¡œë²Œ ìŠ¤íƒ€ì¼
```

## 2. ğŸ§± Detailed Layer Rules

### 1) `app/` (Routing Layer)

- **Role**: Manages URLs (Next.js App Router) and Layouts.
- **âœ… DO**: Import Feature Containers from `components/` and render them.
- **âŒ DON'T**: Write any business logic, `useEffect`, or API calls here.
- **âŒ DON'T**: Define styles here (except for basic layout containers).

### 2) `commons/` (Shared Core)

- **Role**: ëª¨ë“  ê³µìš© ìì‚°ì„ í†µí•© ê´€ë¦¬í•˜ëŠ” ë ˆì´ì–´.
- **Structure**:
  - `apis/`: API í•¨ìˆ˜ + ë°ì´í„° íƒ€ì… (Axios í™œìš©)
  - `providers/`: QueryProvider, Axios ì¸ìŠ¤í„´ìŠ¤ ë“± ì „ì—­ Provider
  - `hooks/`: React Query, Zustand ë“± ë°ì´í„° ë°”ì¸ë”© í›…
  - `components/`: ë””ìì¸ ì‹œìŠ¤í…œ (ê³µìš© ë²„íŠ¼, ì¸í’‹ ë“± ìˆœìˆ˜ UI ì»´í¬ë„ŒíŠ¸)
  - `utils/`: ìˆœìˆ˜ í•¨ìˆ˜ (ë‚ ì§œ í¬ë§·í„°, ê¸ˆì•¡ ì½¤ë§ˆ ì²˜ë¦¬ ë“±)
  - `styles/`: Tailwind CSS ì„¤ì • ë° ê¸€ë¡œë²Œ ìŠ¤íƒ€ì¼
- **âœ… DO**: 
  - Use Props to receive data and actions in components.
  - Create pure functions in utils (Input -> Output).
  - Define API types and functions in apis.
- **âŒ DON'T**: Import from `components/` or `app/`.

### 3) `components/` (Feature Slice - CORE RULE)

Every feature inside `components/` **MUST** follow this strict slice pattern.

#### ğŸ“‚ Feature Directory Structure

Example: Creating a `home` feature.

```text
components/home/
â”œâ”€â”€ index.tsx              # [Entry] Feature Container
â”œâ”€â”€ types.ts               # [Types] Feature-wide Definitions
â”œâ”€â”€ hooks/                 # [Logic] Business Logic (Custom Hooks)
â”‚   â””â”€â”€ useHomeFeature.ts
â””â”€â”€ components/            # [UI] Feature-specific Sub-components
    â”œâ”€â”€ home-view/
    â”‚   â”œâ”€â”€ index.tsx      # View Component
    â”‚   â”œâ”€â”€ styles.ts      # StyleSheet or Tailwind classes
    â”‚   â””â”€â”€ types.ts       # Props
    â””â”€â”€ home-card/
        â”œâ”€â”€ index.tsx
        â””â”€â”€ ...
```

#### ğŸ“ Feature Implementation Rules

1. **Container (`index.tsx`)**:

   - Acts as the "Controller".
   - Imports logic from `hooks/useFeature.ts`.
   - Passes data/handlers to Sub-Components (`components/`).
   - **No direct rendering logic** (HTML/JSX) inside, mostly composition.

2. **Logic (`hooks/`)**:

   - Handles API calls, `useState`, `useEffect`, data fetching.
   - Returns data and functions needed by the view.
   - Uses hooks from `commons/hooks/` for data binding.

3. **Sub-Components (`components/`)**:
   - Must be separated into folders if they are complex.
   - Styles must be in `styles.ts` or use Tailwind classes.
   - Can use components from `commons/components/`.

## 3. âœ… Few-Shot Examples (Best Practices)

### Example: Creating a Feature Container (`components/home/index.tsx`)

```tsx
// âœ… GOOD: Separation of Concerns
import React from 'react';
import { useHomeFeature } from './hooks/useHomeFeature';
import { HomeView } from './components/home-view';
import { HomeCard } from './components/home-card';

export default function HomeFeature() {
  // Logic is completely isolated in the hook
  const { data, handleClick } = useHomeFeature();

  return (
    <div className="flex flex-col">
      <HomeView data={data} />
      <HomeCard onClick={handleClick} />
    </div>
  );
}
```

```tsx
// âŒ BAD: Logic mixed in View
export default function HomeFeature() {
  const [data, setData] = useState(...); // âŒ Logic in container

  useEffect(() => { ... }, []); // âŒ Side effects in container

  return (
    <div>
      {/* âŒ Inline Styles, Raw Components */}
      <div style={{ width: '100px' }}>...</div>
    </div>
  );
}
```

### Example: Using Commons

```tsx
// âœ… GOOD: Using commons components and hooks
import { Button } from '@/commons/components/button';
import { useQuery } from '@/commons/hooks/useQuery';
import { formatDate } from '@/commons/utils/dateFormatter';
import { fetchUserData } from '@/commons/apis/user';

// âŒ BAD: Direct API calls or inline logic
import axios from 'axios'; // âŒ Should use commons/apis
const data = await axios.get(...); // âŒ Should use commons/apis
```

## 4. ğŸš¨ Final Checklist

Before finishing a task, ask yourself:

1. Is business logic isolated in `hooks/`?
2. Are styles separated in `styles.ts` or using Tailwind classes?
3. Is `app/` free of logic?
4. Are pure UI components in `commons/components/`?
5. Are API calls using `commons/apis/`?
6. Are utility functions in `commons/utils/`?
